"use strict";(self["webpackChunkrest"]=self["webpackChunkrest"]||[]).push([[954],{7954:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var o=a(6768);const r={class:"container text-center mt-5"},n={key:0},c={key:1},i={key:2};function s(e,t,a,s,l,d){const f=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",r,[t[3]||(t[3]=(0,o.Lk)("h2",null,"ðŸŽ‰ Payment Status",-1)),l.loading?((0,o.uX)(),(0,o.CE)("div",n,"Verifying payment...")):l.verified?((0,o.uX)(),(0,o.CE)("div",c,[...t[0]||(t[0]=[(0,o.Lk)("p",{class:"text-success"}," âœ… Payment successful! Your ticket has been confirmed, check your email inbox & spam for booking confirmation ",-1)])])):((0,o.uX)(),(0,o.CE)("div",i,[...t[1]||(t[1]=[(0,o.Lk)("p",{class:"text-danger"},"âŒ Payment verification failed.",-1)])])),(0,o.bF)(f,{to:"/",class:"btn btn-primary mt-3"},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("Go Home",-1)])]),_:1})])}var l=a(4373),d=a(782),f=a(9877),g={name:"PaymentSuccess",components:{QrcodeVue:f.Ay},data(){return{reference:"",verified:!1,loading:!0}},computed:{...(0,d.L8)(["getContactInfo","getCart","getSelectedTickets","getCartTotal"])},methods:{async sendOrderInfo(){try{const e=localStorage.getItem("paystack_reference"),t=localStorage.getItem("affiliateCode"),a=localStorage.getItem("promoCode"),o=localStorage.getItem("startDate"),r=localStorage.getItem("startTime"),n=localStorage.getItem("location"),c=Number(localStorage.getItem("finalSubtotal")),i={startDate:o,startTime:r,location:n,promoCode:a,affiliate:t,reference:e,title:this.getCart[0]?.title,contact:{name:`${this.getContactInfo.firstName} ${this.getContactInfo.lastName}`,email:this.getContactInfo.email,phone:this.getContactInfo.phone},userId:this.getCart[0]?.user,tickets:this.getSelectedTickets,price:c};console.log("Sending order info:",i);const s=await l.A.post("https://event-ticket-qa70.onrender.com/api/order",i);console.log("Order info sent:",s.data)}catch(e){console.error("Failed to send order info:",e)}}},async mounted(){if(this.reference=localStorage.getItem("paystack_reference"),this.reference)try{const e=await l.A.get(`https://event-ticket-qa70.onrender.com/api/verify/${this.reference}`);"success"===e.data.data.status&&(this.verified=!0,await this.sendOrderInfo())}catch(e){console.error("Verification error:",e)}finally{this.loading=!1}else this.loading=!1}},m=a(1241);const u=(0,m.A)(g,[["render",s],["__scopeId","data-v-7934ce64"]]);var h=u}}]);
//# sourceMappingURL=954.4171dfae.js.map