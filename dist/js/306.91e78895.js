"use strict";(self["webpackChunkrest"]=self["webpackChunkrest"]||[]).push([[306],{5306:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var r=a(3396),o=a(7139);const n=e=>((0,r.dD)("data-v-0ba37f12"),e=e(),(0,r.Cn)(),e),c={class:"container text-center mt-5"},i=n((()=>(0,r._)("h2",null,"ðŸŽ‰ Payment Status",-1))),s={key:0},l={key:1},d=n((()=>(0,r._)("p",{class:"text-success"},"âœ… Payment successful!",-1))),f=n((()=>(0,r._)("strong",null,"Reference:",-1))),g={key:2},u=n((()=>(0,r._)("p",{class:"text-danger"},"âŒ Payment verification failed.",-1))),m=[u];function p(e,t,a,n,u,p){const h=(0,r.up)("qrcode-vue"),v=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",c,[i,u.loading?((0,r.wg)(),(0,r.iD)("div",s,"Verifying payment...")):u.verified?((0,r.wg)(),(0,r.iD)("div",l,[d,(0,r._)("p",null,[f,(0,r.Uk)(" "+(0,o.zw)(u.reference),1)]),(0,r.Wm)(h,{value:u.reference,size:200},null,8,["value"])])):((0,r.wg)(),(0,r.iD)("div",g,m)),(0,r.Wm)(v,{to:"/",class:"btn btn-primary mt-3"},{default:(0,r.w5)((()=>[(0,r.Uk)("Go Home")])),_:1})])}var h=a(4161),v=a(65),y=a(85),k={name:"PaymentSuccess",components:{QrcodeVue:y.ZP},data(){return{reference:"",verified:!1,loading:!0}},computed:{...(0,v.Se)(["getContactInfo","getCart","getSelectedTickets","getCartTotal"])},methods:{async sendOrderInfo(){try{const e=localStorage.getItem("paystack_reference"),t=localStorage.getItem("affiliateCode"),a=localStorage.getItem("promoCode"),r=localStorage.getItem("startDate"),o=localStorage.getItem("startTime"),n=localStorage.getItem("location"),c=Number(localStorage.getItem("cartTotal")),i={startDate:r,startTime:o,location:n,promoCode:a,affiliate:t,reference:e,title:this.getCart[0]?.title,contact:{email:this.getContactInfo.email,phone:this.getContactInfo.phone},userId:this.getCart[0]?.user,tickets:this.getSelectedTickets,price:c};console.log("Sending order info:",i);const s=await h.Z.post("https://event-ticket-qa70.onrender.com/api/order",i);console.log("Order info sent:",s.data)}catch(e){console.error("Failed to send order info:",e)}}},async mounted(){if(this.reference=localStorage.getItem("paystack_reference"),this.reference)try{const e=await h.Z.get(`https://event-ticket-qa70.onrender.com/api/verify/${this.reference}`);"success"===e.data.data.status&&(this.verified=!0,await this.sendOrderInfo())}catch(e){console.error("Verification error:",e)}finally{this.loading=!1}else this.loading=!1}},I=a(89);const S=(0,I.Z)(k,[["render",p],["__scopeId","data-v-0ba37f12"]]);var C=S}}]);
//# sourceMappingURL=306.91e78895.js.map