"use strict";(self["webpackChunkrest"]=self["webpackChunkrest"]||[]).push([[950],{6950:function(e,t,r){r.r(t),r.d(t,{default:function(){return I}});var n=r(3396),a=r(7139);const o=e=>((0,n.dD)("data-v-7fcbd131"),e=e(),(0,n.Cn)(),e),c={class:"container text-center mt-5"},i=o((()=>(0,n._)("h2",null,"ðŸŽ‰ Payment Status",-1))),s={key:0},l={key:1},d=o((()=>(0,n._)("p",{class:"text-success"},"âœ… Payment successful!",-1))),f=o((()=>(0,n._)("strong",null,"Reference:",-1))),u={key:2},g=o((()=>(0,n._)("p",{class:"text-danger"},"âŒ Payment verification failed.",-1))),m=[g];function p(e,t,r,o,g,p){const h=(0,n.up)("qrcode-vue"),v=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",c,[i,g.loading?((0,n.wg)(),(0,n.iD)("div",s,"Verifying payment...")):g.verified?((0,n.wg)(),(0,n.iD)("div",l,[d,(0,n._)("p",null,[f,(0,n.Uk)(" "+(0,a.zw)(g.reference),1)]),(0,n.Wm)(h,{value:g.reference,size:200},null,8,["value"])])):((0,n.wg)(),(0,n.iD)("div",u,m)),(0,n.Wm)(v,{to:"/",class:"btn btn-primary mt-3"},{default:(0,n.w5)((()=>[(0,n.Uk)("Go Home")])),_:1})])}var h=r(4161),v=r(65),y=r(85),k={name:"PaymentSuccess",components:{QrcodeVue:y.ZP},data(){return{reference:"",verified:!1,loading:!0}},computed:{...(0,v.Se)(["getContactInfo","getCart","getSelectedTickets","getCartTotal"])},methods:{async sendOrderInfo(){try{const e=localStorage.getItem("paystack_reference"),t=localStorage.getItem("affiliateCode"),r=localStorage.getItem("promoCode"),n={promoCode:r,affiliate:t,reference:e,title:this.getCart[0]?.title,contact:{email:this.getContactInfo.email,phone:this.getContactInfo.phone},userId:this.getCart[0]?.user,tickets:this.getSelectedTickets,price:this.getCartTotal};console.log("Sending order info:",n);const a=await h.Z.post("https://event-ticket-qa70.onrender.com/api/order",n);console.log("Order info sent:",a.data)}catch(e){console.error("Failed to send order info:",e)}}},async mounted(){if(this.reference=localStorage.getItem("paystack_reference"),this.reference)try{const e=await h.Z.get(`https://event-ticket-qa70.onrender.com/api/verify/${this.reference}`);"success"===e.data.data.status&&(this.verified=!0,await this.sendOrderInfo())}catch(e){console.error("Verification error:",e)}finally{this.loading=!1}else this.loading=!1}},C=r(89);const w=(0,C.Z)(k,[["render",p],["__scopeId","data-v-7fcbd131"]]);var I=w}}]);
//# sourceMappingURL=950.fa2325dd.js.map