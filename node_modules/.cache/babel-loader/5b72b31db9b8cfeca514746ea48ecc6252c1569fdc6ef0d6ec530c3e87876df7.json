{"ast":null,"code":"import axios from \"axios\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  data() {\n    return {\n      promo: {\n        code: \"\",\n        discountType: \"percentage\",\n        discountValue: 0,\n        expiryDate: \"\",\n        usageLimit: 0,\n        minOrderAmount: 0,\n        products: [] // ✅ selected product IDs\n      },\n\n      promos: [],\n      products: [] // ✅ fetched user products\n    };\n  },\n\n  computed: {\n    ...mapGetters([\"getToken\"])\n  },\n  watch: {\n    \"promo.products\"(newVal) {\n      console.log(\"Selected product IDs:\", newVal);\n    }\n  },\n  methods: {\n    // ✅ POST: Create Promo\n    async createPromo() {\n      try {\n        console.log(this.promo);\n        const res = await axios.post(\"http://localhost:4000/api/create-promo\", this.promo, {\n          headers: {\n            Authorization: `Bearer ${this.getToken}`\n          }\n        });\n      } catch (err) {\n        console.error(err.response?.data || err.message);\n      }\n      this.fetchPromos();\n    },\n    // ✅ GET: Fetch Promos\n    async fetchPromos() {\n      try {\n        const res = await axios.get(\"http://localhost:4000/api/my-promos\", {\n          headers: {\n            Authorization: `Bearer ${this.getToken}`\n          }\n        });\n        this.promos = res.data.promos;\n      } catch (err) {\n        console.error(err.response?.data || err.message);\n      }\n    },\n    async fetchMyPromos() {\n      try {\n        const res = await axios.get(\"http://localhost:4000/api/promo-orders\", {\n          headers: {\n            Authorization: `Bearer ${this.getToken}`\n          }\n        });\n        this.promos = res.data;\n        console.log(\"promos\", this.promos);\n      } catch (err) {\n        console.error(err.response?.data || err.message);\n      }\n    },\n    // ✅ GET: Fetch User Products\n    async fetchProducts() {\n      try {\n        const res = await axios.get(\"http://localhost:4000/api/user/products\", {\n          headers: {\n            Authorization: `Bearer ${this.getToken}`\n          }\n        });\n        this.products = res.data.products;\n      } catch (error) {\n        console.error(\"Error fetching products:\", error);\n      }\n    }\n  },\n  mounted() {\n    this.fetchProducts();\n    this.fetchMyPromos();\n    this.fetchPromos();\n  }\n};","map":{"version":3,"names":["axios","mapGetters","data","promo","code","discountType","discountValue","expiryDate","usageLimit","minOrderAmount","products","promos","computed","watch","promo.products","newVal","console","log","methods","createPromo","res","post","headers","Authorization","getToken","err","error","response","message","fetchPromos","get","fetchMyPromos","fetchProducts","mounted"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\event-ticket-frontend\\src\\components\\dashboard\\discount.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-4\">\r\n    <!-- Create Promo Form -->\r\n    <h2>Create Promo Code</h2>\r\n    <form @submit.prevent=\"createPromo\" class=\"mb-4\">\r\n      <input v-model=\"promo.code\" placeholder=\"Code\" class=\"form-control mb-2\" />\r\n\r\n      <select v-model=\"promo.discountType\" class=\"form-control mb-2\">\r\n        <option value=\"percentage\">Percentage</option>\r\n        <option value=\"fixed\">Fixed</option>\r\n      </select>\r\n\r\n      <input\r\n        v-model.number=\"promo.discountValue\"\r\n        type=\"number\"\r\n        placeholder=\"Discount Value\"\r\n        class=\"form-control mb-2\"\r\n      />\r\n      <input v-model=\"promo.expiryDate\" type=\"date\" class=\"form-control mb-2\" />\r\n      <input\r\n        v-model.number=\"promo.usageLimit\"\r\n        type=\"number\"\r\n        placeholder=\"Usage Limit\"\r\n        class=\"form-control mb-2\"\r\n      />\r\n      <input\r\n        v-model.number=\"promo.minOrderAmount\"\r\n        type=\"number\"\r\n        placeholder=\"Minimum Order Amount\"\r\n        class=\"form-control mb-2\"\r\n      />\r\n\r\n      <!-- ✅ Product selector -->\r\n      <label>Select Products</label>\r\n      <select v-model=\"promo.products\" multiple class=\"form-select mb-2\">\r\n        <option v-for=\"product in products\" :key=\"product._id\" :value=\"product._id\">\r\n          {{ product.title }}\r\n        </option>\r\n      </select>\r\n\r\n      <button type=\"submit\" class=\"btn btn-primary\">Create Promo</button>\r\n    </form>\r\n\r\n    <!-- Fetch Promos -->\r\n    <h2>My Promo Codes</h2>\r\n    <button @click=\"fetchPromos\" class=\"btn btn-success mb-3\">Load Promos</button>\r\n    <ul v-if=\"promos && promos.length\">\r\n      <li v-for=\"p in promos\" :key=\"p._id\">\r\n        <strong>{{ p.code }}</strong> → {{ p.discountType }}\r\n        {{ p.discountValue }} (Expires: {{ new Date(p.expiryDate).toLocaleDateString() }})\r\n        <br />\r\n        Products: {{ p.products.map((prod) => prod.name).join(\", \") }}\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { mapGetters } from \"vuex\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      promo: {\r\n        code: \"\",\r\n        discountType: \"percentage\",\r\n        discountValue: 0,\r\n        expiryDate: \"\",\r\n        usageLimit: 0,\r\n        minOrderAmount: 0,\r\n        products: [], // ✅ selected product IDs\r\n      },\r\n      promos: [],\r\n      products: [], // ✅ fetched user products\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"getToken\"]),\r\n  },\r\n  watch: {\r\n    \"promo.products\"(newVal) {\r\n      console.log(\"Selected product IDs:\", newVal);\r\n    },\r\n  },\r\n  methods: {\r\n    // ✅ POST: Create Promo\r\n    async createPromo() {\r\n      try {\r\n        console.log(this.promo);\r\n        const res = await axios.post(\r\n          \"http://localhost:4000/api/create-promo\",\r\n          this.promo,\r\n\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${this.getToken}`,\r\n            },\r\n          }\r\n        );\r\n      } catch (err) {\r\n        console.error(err.response?.data || err.message);\r\n      }\r\n      this.fetchPromos();\r\n    },\r\n\r\n    // ✅ GET: Fetch Promos\r\n    async fetchPromos() {\r\n      try {\r\n        const res = await axios.get(\"http://localhost:4000/api/my-promos\", {\r\n          headers: {\r\n            Authorization: `Bearer ${this.getToken}`,\r\n          },\r\n        });\r\n        this.promos = res.data.promos;\r\n      } catch (err) {\r\n        console.error(err.response?.data || err.message);\r\n      }\r\n    },\r\n    async fetchMyPromos() {\r\n      try {\r\n        const res = await axios.get(\"http://localhost:4000/api/promo-orders\", {\r\n          headers: {\r\n            Authorization: `Bearer ${this.getToken}`,\r\n          },\r\n        });\r\n        this.promos = res.data;\r\n        console.log(\"promos\", this.promos);\r\n      } catch (err) {\r\n        console.error(err.response?.data || err.message);\r\n      }\r\n    },\r\n\r\n    // ✅ GET: Fetch User Products\r\n    async fetchProducts() {\r\n      try {\r\n        const res = await axios.get(\"http://localhost:4000/api/user/products\", {\r\n          headers: {\r\n            Authorization: `Bearer ${this.getToken}`,\r\n          },\r\n        });\r\n        this.products = res.data.products;\r\n      } catch (error) {\r\n        console.error(\"Error fetching products:\", error);\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fetchProducts();\r\n    this.fetchMyPromos();\r\n    this.fetchPromos();\r\n  },\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}