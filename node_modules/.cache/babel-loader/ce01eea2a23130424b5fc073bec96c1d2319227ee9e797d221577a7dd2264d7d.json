{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  key: 2,\n  class: \"error\"\n};\nconst _hoisted_3 = {\n  class: \"decode-result\"\n};\nconst _hoisted_4 = {\n  key: 3,\n  class: \"text-start\",\n  style: {\n    \"border\": \"1px solid #ddd\",\n    \"border-radius\": \"8px\",\n    \"padding\": \"16px\",\n    \"background\": \"#f9f9f9\",\n    \"max-width\": \"600px\"\n  }\n};\nconst _hoisted_5 = {\n  style: {\n    \"width\": \"120px\",\n    \"font-weight\": \"bold\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"border-left\": \"1px solid #ccc\",\n    \"padding-left\": \"12px\"\n  }\n};\nconst _hoisted_7 = {\n  style: {\n    \"display\": \"flex\",\n    \"border-top\": \"1px solid #ddd\",\n    \"padding\": \"8px 0\"\n  }\n};\nconst _hoisted_8 = {\n  style: {\n    \"border-left\": \"1px solid #ccc\",\n    \"padding-left\": \"12px\"\n  }\n};\nconst _hoisted_9 = {\n  style: {\n    \"margin\": \"0\",\n    \"padding-left\": \"20px\"\n  }\n};\nconst _hoisted_10 = {\n  key: 4\n};\nexport function render(_ctx, _cache) {\n  const _component_qrcode_stream = _resolveComponent(\"qrcode-stream\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"üéØ Scan Ticket QR Code\", -1 /* CACHED */)), _createCommentVNode(\" Button to start scanning \"), !_ctx.scanning ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[0] || (_cache[0] = (...args) => _ctx.startScanning && _ctx.startScanning(...args)),\n    class: \"btn btn-primary mb-3\"\n  }, \" üì∑ Start Scanning \")) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" QR Scanner \"), _ctx.scanning ? (_openBlock(), _createBlock(_component_qrcode_stream, {\n    key: 1,\n    constraints: {\n      facingMode: 'environment'\n    },\n    onDetect: _ctx.onDetect,\n    onError: _ctx.onError\n  }, null, 8 /* PROPS */, [\"onDetect\", \"onError\"])) : _createCommentVNode(\"v-if\", true), _ctx.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_2, _toDisplayString(_ctx.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"p\", _hoisted_3, [_createElementVNode(\"b\", null, _toDisplayString(_ctx.result), 1 /* TEXT */)]), _createCommentVNode(\" Ticket details \"), _ctx.ticket ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[2] || (_cache[2] = _createElementVNode(\"h4\", {\n    style: {\n      \"margin-bottom\": \"16px\"\n    }\n  }, \"üéüÔ∏è Ticket Details\", -1 /* CACHED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList({\n    Event: _ctx.ticket.title,\n    Reference: _ctx.ticket.reference,\n    Email: _ctx.ticket.contact?.email || 'N/A',\n    Phone: _ctx.ticket.contact?.phone || 'N/A'\n  }, (value, label) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      style: {\n        \"display\": \"flex\",\n        \"border-top\": \"1px solid #ddd\",\n        \"padding\": \"8px 0\"\n      },\n      key: label\n    }, [_createElementVNode(\"div\", _hoisted_5, _toDisplayString(label) + \":\", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, _toDisplayString(value), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\" Tickets \"), _createElementVNode(\"div\", _hoisted_7, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n    style: {\n      \"width\": \"120px\",\n      \"font-weight\": \"bold\"\n    }\n  }, \"Tickets:\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"ul\", _hoisted_9, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.ticket.tickets, t => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: t._id\n    }, _toDisplayString(t.name) + \" x \" + _toDisplayString(t.quantity), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])])])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Ticket not found \"), _ctx.notFound ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [...(_cache[3] || (_cache[3] = [_createElementVNode(\"p\", {\n    class: \"text-danger\"\n  }, \"‚ùå Ticket not found.\", -1 /* CACHED */)]))])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","_ctx","scanning","onClick","_cache","args","startScanning","_createBlock","_component_qrcode_stream","constraints","facingMode","onDetect","onError","error","_hoisted_2","_toDisplayString","_hoisted_3","result","ticket","_hoisted_4","_Fragment","_renderList","title","reference","contact","email","phone","value","label","key","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","tickets","t","_id","name","quantity","notFound","_hoisted_10"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\New folder\\event-ticket-frontend\\src\\components\\app\\admin\\scanner.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2>üéØ Scan Ticket QR Code</h2>\r\n\r\n    <!-- Button to start scanning -->\r\n    <button v-if=\"!scanning\" @click=\"startScanning\" class=\"btn btn-primary mb-3\">\r\n      üì∑ Start Scanning\r\n    </button>\r\n\r\n    <!-- QR Scanner -->\r\n    <qrcode-stream\r\n      v-if=\"scanning\"\r\n      :constraints=\"{ facingMode: 'environment' }\"\r\n      @detect=\"onDetect\"\r\n      @error=\"onError\"\r\n    />\r\n\r\n    <p v-if=\"error\" class=\"error\">{{ error }}</p>\r\n    <p class=\"decode-result\">\r\n      <b>{{ result }}</b>\r\n    </p>\r\n\r\n    <!-- Ticket details -->\r\n    <div\r\n      v-if=\"ticket\"\r\n      class=\"text-start\"\r\n      style=\"\r\n        border: 1px solid #ddd;\r\n        border-radius: 8px;\r\n        padding: 16px;\r\n        background: #f9f9f9;\r\n        max-width: 600px;\r\n      \"\r\n    >\r\n      <h4 style=\"margin-bottom: 16px\">üéüÔ∏è Ticket Details</h4>\r\n\r\n      <div\r\n        style=\"display: flex; border-top: 1px solid #ddd; padding: 8px 0\"\r\n        v-for=\"(value, label) in {\r\n          Event: ticket.title,\r\n          Reference: ticket.reference,\r\n          Email: ticket.contact?.email || 'N/A',\r\n          Phone: ticket.contact?.phone || 'N/A',\r\n        }\"\r\n        :key=\"label\"\r\n      >\r\n        <div style=\"width: 120px; font-weight: bold\">{{ label }}:</div>\r\n        <div style=\"border-left: 1px solid #ccc; padding-left: 12px\">{{ value }}</div>\r\n      </div>\r\n\r\n      <!-- Tickets -->\r\n      <div style=\"display: flex; border-top: 1px solid #ddd; padding: 8px 0\">\r\n        <div style=\"width: 120px; font-weight: bold\">Tickets:</div>\r\n        <div style=\"border-left: 1px solid #ccc; padding-left: 12px\">\r\n          <ul style=\"margin: 0; padding-left: 20px\">\r\n            <li v-for=\"t in ticket.tickets\" :key=\"t._id\">\r\n              {{ t.name }} x {{ t.quantity }}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Ticket not found -->\r\n    <div v-if=\"notFound\">\r\n      <p class=\"text-danger\">‚ùå Ticket not found.</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QrcodeStream } from \"vue-qrcode-reader\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"QRScanner\",\r\n  components: { QrcodeStream },\r\n  data() {\r\n    return {\r\n      scanning: false, // Controls camera visibility\r\n      result: \"\",\r\n      ticket: null,\r\n      error: \"\",\r\n      notFound: false,\r\n    };\r\n  },\r\n  methods: {\r\n    startScanning() {\r\n      this.scanning = true;\r\n    },\r\n    async onDetect(detectedCodes) {\r\n      const reference = detectedCodes[0]?.rawValue;\r\n      this.result = reference;\r\n      this.ticket = null;\r\n      this.notFound = false;\r\n      this.error = \"\"; // Reset error message\r\n\r\n      try {\r\n<<<<<<< HEAD\r\n        const res = await axios.get(`https://95eb7e2b76c5.ngrok-free.app/api/order/${reference}`);\r\n=======\r\n        const res = await axios.get(`http://localhost:4000/api/order/${reference}`);\r\n>>>>>>> 24f4f118 (m)\r\n        this.ticket = res.data.order;\r\n      } catch (err) {\r\n        if (err.response) {\r\n          if (err.response.status === 404) {\r\n            this.notFound = true;\r\n          } else if (err.response.status === 409) {\r\n            this.error = \"‚ùå This ticket has already been scanned.\";\r\n            window.alert(this.error); // ‚úÖ Show popup alert\r\n          } else {\r\n            this.error = \"‚ö†Ô∏è Server error. Please try again.\";\r\n            window.alert(this.error);\r\n          }\r\n        } else {\r\n          this.error = \"‚ö†Ô∏è Network error. Please check your connection.\";\r\n          window.alert(this.error);\r\n        }\r\n\r\n        console.error(err);\r\n      }\r\n    },\r\n    onError(err) {\r\n      console.error(err);\r\n      this.error = \"Camera access or scanning failed.\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  max-width: 600px;\r\n  margin: 2rem auto;\r\n  text-align: center;\r\n}\r\n.decode-result {\r\n  margin-top: 1rem;\r\n  font-size: 1.2rem;\r\n}\r\n.error {\r\n  color: red;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAW;;;EAgBJA,KAAK,EAAC;;;EACnBA,KAAK,EAAC;AAAe;;;EAOtBA,KAAK,EAAC,YAAY;EAClBC,KAMC,EAND;IAAA;IAAA;IAAA;IAAA;IAAA;EAAA;;;EAoBOA,KAAuC,EAAvC;IAAA;IAAA;EAAA;AAAuC;;EACvCA,KAAuD,EAAvD;IAAA;IAAA;EAAA;AAAuD;;EAIzDA,KAAiE,EAAjE;IAAA;IAAA;IAAA;EAAA;AAAiE;;EAE/DA,KAAuD,EAAvD;IAAA;IAAA;EAAA;AAAuD;;EACtDA,KAAqC,EAArC;IAAA;IAAA;EAAA;AAAqC;;;;;;uBArDjDC,mBAAA,CAkEM,OAlENC,UAkEM,G,0BAjEJC,mBAAA,CAA+B,YAA3B,wBAAsB,qBAE1BC,mBAAA,8BAAiC,E,CAClBC,IAAA,CAAAC,QAAQ,I,cAAvBL,mBAAA,CAES;;IAFiBM,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEJ,IAAA,CAAAK,aAAA,IAAAL,IAAA,CAAAK,aAAA,IAAAD,IAAA,CAAa;IAAEV,KAAK,EAAC;KAAuB,qBAE7E,K,mCAEAK,mBAAA,gBAAmB,EAEXC,IAAA,CAAAC,QAAQ,I,cADhBK,YAAA,CAKEC,wBAAA;;IAHCC,WAAW,EAAE;MAAAC,UAAA;IAAA,CAA6B;IAC1CC,QAAM,EAAEV,IAAA,CAAAU,QAAQ;IAChBC,OAAK,EAAEX,IAAA,CAAAW;yFAGDX,IAAA,CAAAY,KAAK,I,cAAdhB,mBAAA,CAA6C,KAA7CiB,UAA6C,EAAAC,gBAAA,CAAZd,IAAA,CAAAY,KAAK,oB,mCACtCd,mBAAA,CAEI,KAFJiB,UAEI,GADFjB,mBAAA,CAAmB,WAAAgB,gBAAA,CAAbd,IAAA,CAAAgB,MAAM,iB,GAGdjB,mBAAA,oBAAuB,EAEfC,IAAA,CAAAiB,MAAM,I,cADdrB,mBAAA,CAsCM,OAtCNsB,UAsCM,G,0BA3BJpB,mBAAA,CAAuD;IAAnDH,KAA2B,EAA3B;MAAA;IAAA;EAA2B,GAAC,oBAAkB,sB,kBAElDC,mBAAA,CAYMuB,SAAA,QAAAC,WAAA;WAVyCpB,IAAA,CAAAiB,MAAM,CAACI,KAAK;eAAwBrB,IAAA,CAAAiB,MAAM,CAACK,SAAS;WAAoBtB,IAAA,CAAAiB,MAAM,CAACM,OAAO,EAAEC,KAAK;WAA6BxB,IAAA,CAAAiB,MAAM,CAACM,OAAO,EAAEE,KAAK;MAApLC,KAAK,EAAEC,KAAK;yBAFtB/B,mBAAA,CAYM;MAXJD,KAAiE,EAAjE;QAAA;QAAA;QAAA;MAAA,CAAiE;MAOhEiC,GAAG,EAAED;QAEN7B,mBAAA,CAA+D,OAA/D+B,UAA+D,EAAAf,gBAAA,CAAfa,KAAK,IAAG,GAAC,iBACzD7B,mBAAA,CAA8E,OAA9EgC,UAA8E,EAAAhB,gBAAA,CAAdY,KAAK,iB;kCAGvE3B,mBAAA,aAAgB,EAChBD,mBAAA,CASM,OATNiC,UASM,G,0BARJjC,mBAAA,CAA2D;IAAtDH,KAAuC,EAAvC;MAAA;MAAA;IAAA;EAAuC,GAAC,UAAQ,qBACrDG,mBAAA,CAMM,OANNkC,UAMM,GALJlC,mBAAA,CAIK,MAJLmC,UAIK,I,kBAHHrC,mBAAA,CAEKuB,SAAA,QAAAC,WAAA,CAFWpB,IAAA,CAAAiB,MAAM,CAACiB,OAAO,EAAnBC,CAAC;yBAAZvC,mBAAA,CAEK;MAF4BgC,GAAG,EAAEO,CAAC,CAACC;wBACnCD,CAAC,CAACE,IAAI,IAAG,KAAG,GAAAvB,gBAAA,CAAGqB,CAAC,CAACG,QAAQ;+EAOtCvC,mBAAA,sBAAyB,EACdC,IAAA,CAAAuC,QAAQ,I,cAAnB3C,mBAAA,CAEM,OAAA4C,WAAA,OAAArC,MAAA,QAAAA,MAAA,OADJL,mBAAA,CAA8C;IAA3CJ,KAAK,EAAC;EAAa,GAAC,qBAAmB,mB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}