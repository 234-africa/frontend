{"ast":null,"code":"import { QrcodeStream } from \"vue-qrcode-reader\";\nimport axios from \"axios\";\nexport default {\n  name: \"QRScanner\",\n  components: {\n    QrcodeStream\n  },\n  data() {\n    return {\n      scanning: false,\n      // Controls camera visibility\n      result: \"\",\n      ticket: null,\n      error: \"\",\n      notFound: false\n    };\n  },\n  methods: {\n    startScanning() {\n      this.scanning = true;\n    },\n    async onDetect(detectedCodes) {\n      const reference = detectedCodes[0]?.rawValue;\n      this.result = reference;\n      this.ticket = null;\n      this.notFound = false;\n      this.error = \"\"; // Reset error message\n\n      try {\n        const res = await axios.get(`https://event-ticket-backend-gnmw.onrender.com/api/order/${reference}`);\n        this.ticket = res.data.order;\n      } catch (err) {\n        if (err.response) {\n          if (err.response.status === 404) {\n            this.notFound = true;\n          } else if (err.response.status === 409) {\n            this.error = \"‚ùå This ticket has already been scanned.\";\n            window.alert(this.error); // ‚úÖ Show popup alert\n          } else {\n            this.error = \"‚ö†Ô∏è Server error. Please try again.\";\n            window.alert(this.error);\n          }\n        } else {\n          this.error = \"‚ö†Ô∏è Network error. Please check your connection.\";\n          window.alert(this.error);\n        }\n        console.error(err);\n      }\n    },\n    onError(err) {\n      console.error(err);\n      this.error = \"Camera access or scanning failed.\";\n    }\n  }\n};","map":{"version":3,"names":["QrcodeStream","axios","name","components","data","scanning","result","ticket","error","notFound","methods","startScanning","onDetect","detectedCodes","reference","rawValue","res","get","order","err","response","status","window","alert","console","onError"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\xASn2901-Daredevil\\event-ticket-frontend\\src\\components\\app\\admin\\scanner.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2>üéØ Scan Ticket QR Code</h2>\r\n\r\n    <!-- Button to start scanning -->\r\n    <button v-if=\"!scanning\" @click=\"startScanning\" class=\"btn btn-primary mb-3\">\r\n      üì∑ Start Scanning\r\n    </button>\r\n\r\n    <!-- QR Scanner -->\r\n    <qrcode-stream\r\n      v-if=\"scanning\"\r\n      :constraints=\"{ facingMode: 'environment' }\"\r\n      @detect=\"onDetect\"\r\n      @error=\"onError\"\r\n    />\r\n\r\n    <p v-if=\"error\" class=\"error\">{{ error }}</p>\r\n    <p class=\"decode-result\">\r\n      <b>{{ result }}</b>\r\n    </p>\r\n\r\n    <!-- Ticket details -->\r\n    <div\r\n      v-if=\"ticket\"\r\n      class=\"text-start\"\r\n      style=\"\r\n        border: 1px solid #ddd;\r\n        border-radius: 8px;\r\n        padding: 16px;\r\n        background: #f9f9f9;\r\n        max-width: 600px;\r\n      \"\r\n    >\r\n      <h4 style=\"margin-bottom: 16px\">üéüÔ∏è Ticket Details</h4>\r\n\r\n      <div\r\n        style=\"display: flex; border-top: 1px solid #ddd; padding: 8px 0\"\r\n        v-for=\"(value, label) in {\r\n          Event: ticket.title,\r\n          Reference: ticket.reference,\r\n          Email: ticket.contact?.email || 'N/A',\r\n          Phone: ticket.contact?.phone || 'N/A',\r\n        }\"\r\n        :key=\"label\"\r\n      >\r\n        <div style=\"width: 120px; font-weight: bold\">{{ label }}:</div>\r\n        <div style=\"border-left: 1px solid #ccc; padding-left: 12px\">{{ value }}</div>\r\n      </div>\r\n\r\n      <!-- Tickets -->\r\n      <div style=\"display: flex; border-top: 1px solid #ddd; padding: 8px 0\">\r\n        <div style=\"width: 120px; font-weight: bold\">Tickets:</div>\r\n        <div style=\"border-left: 1px solid #ccc; padding-left: 12px\">\r\n          <ul style=\"margin: 0; padding-left: 20px\">\r\n            <li v-for=\"t in ticket.tickets\" :key=\"t._id\">\r\n              {{ t.name }} x {{ t.quantity }}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Ticket not found -->\r\n    <div v-if=\"notFound\">\r\n      <p class=\"text-danger\">‚ùå Ticket not found.</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QrcodeStream } from \"vue-qrcode-reader\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"QRScanner\",\r\n  components: { QrcodeStream },\r\n  data() {\r\n    return {\r\n      scanning: false, // Controls camera visibility\r\n      result: \"\",\r\n      ticket: null,\r\n      error: \"\",\r\n      notFound: false,\r\n    };\r\n  },\r\n  methods: {\r\n    startScanning() {\r\n      this.scanning = true;\r\n    },\r\n    async onDetect(detectedCodes) {\r\n      const reference = detectedCodes[0]?.rawValue;\r\n      this.result = reference;\r\n      this.ticket = null;\r\n      this.notFound = false;\r\n      this.error = \"\"; // Reset error message\r\n\r\n      try {\r\n        const res = await axios.get(`https://event-ticket-backend-gnmw.onrender.com/api/order/${reference}`);\r\n        this.ticket = res.data.order;\r\n      } catch (err) {\r\n        if (err.response) {\r\n          if (err.response.status === 404) {\r\n            this.notFound = true;\r\n          } else if (err.response.status === 409) {\r\n            this.error = \"‚ùå This ticket has already been scanned.\";\r\n            window.alert(this.error); // ‚úÖ Show popup alert\r\n          } else {\r\n            this.error = \"‚ö†Ô∏è Server error. Please try again.\";\r\n            window.alert(this.error);\r\n          }\r\n        } else {\r\n          this.error = \"‚ö†Ô∏è Network error. Please check your connection.\";\r\n          window.alert(this.error);\r\n        }\r\n\r\n        console.error(err);\r\n      }\r\n    },\r\n    onError(err) {\r\n      console.error(err);\r\n      this.error = \"Camera access or scanning failed.\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  max-width: 600px;\r\n  margin: 2rem auto;\r\n  text-align: center;\r\n}\r\n.decode-result {\r\n  margin-top: 1rem;\r\n  font-size: 1.2rem;\r\n}\r\n.error {\r\n  color: red;\r\n}\r\n</style>\r\n"],"mappings":"AAuEA,SAASA,YAAW,QAAS,mBAAmB;AAChD,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,UAAU,EAAE;IAAEH;EAAa,CAAC;EAC5BI,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,KAAK;MAAE;MACjBC,MAAM,EAAE,EAAE;MACVC,MAAM,EAAE,IAAI;MACZC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE;IACZ,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,aAAaA,CAAA,EAAG;MACd,IAAI,CAACN,QAAO,GAAI,IAAI;IACtB,CAAC;IACD,MAAMO,QAAQA,CAACC,aAAa,EAAE;MAC5B,MAAMC,SAAQ,GAAID,aAAa,CAAC,CAAC,CAAC,EAAEE,QAAQ;MAC5C,IAAI,CAACT,MAAK,GAAIQ,SAAS;MACvB,IAAI,CAACP,MAAK,GAAI,IAAI;MAClB,IAAI,CAACE,QAAO,GAAI,KAAK;MACrB,IAAI,CAACD,KAAI,GAAI,EAAE,EAAE;;MAEjB,IAAI;QACF,MAAMQ,GAAE,GAAI,MAAMf,KAAK,CAACgB,GAAG,CAAC,4DAA4DH,SAAS,EAAE,CAAC;QACpG,IAAI,CAACP,MAAK,GAAIS,GAAG,CAACZ,IAAI,CAACc,KAAK;MAC9B,EAAE,OAAOC,GAAG,EAAE;QACZ,IAAIA,GAAG,CAACC,QAAQ,EAAE;UAChB,IAAID,GAAG,CAACC,QAAQ,CAACC,MAAK,KAAM,GAAG,EAAE;YAC/B,IAAI,CAACZ,QAAO,GAAI,IAAI;UACtB,OAAO,IAAIU,GAAG,CAACC,QAAQ,CAACC,MAAK,KAAM,GAAG,EAAE;YACtC,IAAI,CAACb,KAAI,GAAI,yCAAyC;YACtDc,MAAM,CAACC,KAAK,CAAC,IAAI,CAACf,KAAK,CAAC,EAAE;UAC5B,OAAO;YACL,IAAI,CAACA,KAAI,GAAI,oCAAoC;YACjDc,MAAM,CAACC,KAAK,CAAC,IAAI,CAACf,KAAK,CAAC;UAC1B;QACF,OAAO;UACL,IAAI,CAACA,KAAI,GAAI,iDAAiD;UAC9Dc,MAAM,CAACC,KAAK,CAAC,IAAI,CAACf,KAAK,CAAC;QAC1B;QAEAgB,OAAO,CAAChB,KAAK,CAACW,GAAG,CAAC;MACpB;IACF,CAAC;IACDM,OAAOA,CAACN,GAAG,EAAE;MACXK,OAAO,CAAChB,KAAK,CAACW,GAAG,CAAC;MAClB,IAAI,CAACX,KAAI,GAAI,mCAAmC;IAClD;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}